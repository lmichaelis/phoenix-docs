
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>The ZEN archive format - ZenGin Reference</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9647289d.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-zen-archive-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ZenGin Reference" class="md-header__button md-logo" aria-label="ZenGin Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZenGin Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The ZEN archive format
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZenGin Reference" class="md-nav__button md-logo" aria-label="ZenGin Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ZenGin Reference
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        The ZenGin Reference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Format
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Format" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Format
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fnt/" class="md-nav__link">
        The FNT file format
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tex/" class="md-nav__link">
        The TEX file format
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vdf/" class="md-nav__link">
        The VDF file format
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The ZEN archive format
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        The ZEN archive format
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-concepts" class="md-nav__link">
    General Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entries" class="md-nav__link">
    Entries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ascii" class="md-nav__link">
    ASCII
  </a>
  
    <nav class="md-nav" aria-label="ASCII">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_1" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_1" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_1" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary" class="md-nav__link">
    Binary
  </a>
  
    <nav class="md-nav" aria-label="Binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_2" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_2" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_2" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#safe-binary" class="md-nav__link">
    Safe Binary
  </a>
  
    <nav class="md-nav" aria-label="Safe Binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_3" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_3" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_3" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Miscellaneous
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Miscellaneous" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/chunked/" class="md-nav__link">
        The chunked binary format
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-concepts" class="md-nav__link">
    General Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    Objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entries" class="md-nav__link">
    Entries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ascii" class="md-nav__link">
    ASCII
  </a>
  
    <nav class="md-nav" aria-label="ASCII">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_1" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_1" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_1" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary" class="md-nav__link">
    Binary
  </a>
  
    <nav class="md-nav" aria-label="Binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_2" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_2" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_2" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#safe-binary" class="md-nav__link">
    Safe Binary
  </a>
  
    <nav class="md-nav" aria-label="Safe Binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header_3" class="md-nav__link">
    Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects_3" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entries_3" class="md-nav__link">
    Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="the-zen-archive-format">The ZEN archive format</h1>
<p><em>ZenGin</em> archives (<em>ZEN</em> files) contain generic data for use with the <em>ZenGin</em>. Most archives store key-value pairs
organized into objects, similar to <a href="https://en.wikipedia.org/wiki/JSON">JSON</a>. Archives have three different encodings: 
<a href="#binary">binary</a> archives store unannotated bytes, <a href="#safe-binary">safe binary</a> archives store binary data annotated
with field types and names and <a href="#ascii">ascii</a> archives contain a human-readable form of the same data stored in 
<em>safe binary</em> archives.</p>
<h2 id="general-concepts">General Concepts</h2>
<p>A basic <em>ZEN</em> file might look like this.</p>
<div class="highlight"><span class="filename">Example ZEN archive (ASCII)</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ZenGin Archive
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>ver 1
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>zCArchiverGeneric
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>ASCII
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>saveGame 0
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>date 17.9.2002 15:21:1
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>user mario.roeske
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>END
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>objects 7        
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>END
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>[% oCWorld:zCWorld 64513 0]
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    [VobTree % 0 0]
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        childs0=int:1
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        [% zCVob 39168 1]
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            pack=int:0
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>            presetName=string:LIGHT
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>            bbox3DWS=rawFloat:334.003906 -443.912476 -7493.55371 2734.00391 1956.08765 -5093.55371 
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>            trafoOSToWSRot=raw:974226bf00000000a9a9423f000000000000803f00000000a9a942bf00000000974226bf
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>            trafoOSToWSPos=vec3:1534.00403 756.087585 -6293.55371
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>            vobName=string:LIGHT
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            visual=string:
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            showVisual=bool:0
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            visualCamAlign=enum:0
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            visualAniMode=enum:0
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            visualAniModeStrength=float:0
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>            vobFarClipZScale=float:1
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            cdStatic=bool:0
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>            cdDyn=bool:0
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>            staticVob=bool:1
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>            dynShadow=enum:0
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>            zbias=int:1
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>            isAmbient=bool:0
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>            [visual % 0 0]
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>            []
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>            [ai % 0 0]
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>            []
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>        []
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    []
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>[]
</code></pre></div>
<p>At the beginning of the file, the <a href="#header">header</a> is defined. It consists of two parts, the first one being the same
across all encoding and the second being specific to the encoding used. The data content of the file starts right after
the second <code>END</code>. The first line of the file's content, <code>[% oCWorld:zCWorld 64513 0]</code>, marks the start of a new
<a href="#objects">object</a> while the last line, <code>[]</code> marks the end of an <a href="#objects">object</a>.</p>
<p>Each <a href="#objects">object</a> can contain multiple <a href="#entries">entries</a> alongside other <a href="#objects">objects</a>. Each 
<a href="#entries">entry</a> has a name, a type and a value. This only applies to <a href="#ascii">ascii</a> and <a href="#safe-binary">safe binary</a>
encodings.</p>
<h2 id="header">Header</h2>
<p>The header of ZEN archives consists of two parts. The first has the same structure for every archive and the second
differs between encodings. The first part of the header looks like this. Variable elements of the header have been
replaced by <code>&lt;...&gt;</code> placeholders.</p>
<div class="highlight"><span class="filename">Example ZEN archive header</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>ZenGin Archive
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>ver 1
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>&lt;archiver&gt;
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>&lt;encoding&gt;
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>saveGame &lt;issave&gt;
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>date &lt;timestamp&gt;
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>user &lt;username&gt;
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>END
</code></pre></div>
<p>Line breaks denote only one newline (<code>\n</code>) character. The <code>&lt;archiver&gt;</code> is a string value, being either
<code>zCArchiverGeneric</code> or <code>zCArchiverBinSafe</code>, in reference to the names of the ZEN archive parser classes in the 
original source code. <code>&lt;encoding&gt;</code> specifies the type of archive in the file. It is either <code>ASCII</code>
(for <a href="#ascii">ascii</a> encoded archives), <code>BINARY</code> (for <a href="#binary">binary</a> encoded archives) or <code>BIN_SAFE</code> 
(for <a href="#safe-binary">safe binary</a> encoded archives). If the archive is a save game file <code>&lt;issave&gt;</code> is set to <code>1</code>,
otherwise it is <code>0</code>. <code>&lt;timestamp&gt;</code> denotes the date and time the archive was created. It follows the
<a href="https://linux.die.net/man/3/strptime">strptime</a> format <code>%d.%m.%Y %H:%M:%S</code>. <code>&lt;username&gt;</code> is the name of the user 
(originally the windows account name) the archive was created by. For save games this contains the name of the user
who saved the game. Refer to the <a href="#general-concepts">example</a> above for a filled-out version of the header.</p>
<p>The encoding-specific headers follow directly after the <code>END\n</code> line of the first header as can be seen in the 
example.</p>
<h2 id="objects">Objects</h2>
<p>Objects in ZEN archives consist of an <em>object name</em>, a <em>class name</em>, a <em>version</em> identifier and an <em>index</em>. The object
name is used to describe a unique sub-object of another while the class name is used to identify the type of the object.
A ZEN archive object <code>[visual zCParticleFX 0 6]</code> describes a specific sub-object <code>visual</code> of type <code>zCParticleFX</code>
meaning it has a set of <a href="#entries">entries</a> consistent with the definition of a <code>zCParticleFX</code>. Objects without an 
object name just contain a <code>%</code> instead. Objects always end with <code>[]</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This behavior can be seen in the example <a href="#general-concepts">above</a>. Every object with the class name <code>zCVob</code> has
the same set of entries as shown in the example.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The object name must be unique within each sub-object. A ZEN archive like this is invalid.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>[% oCWorld:zCWorld 64513 0]
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    [VobTree % 0 0]
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    []
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    [VobTree % 0 0]
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    []
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>[]
</code></pre></div>
</div>
<p>Class names originally referenced a specific class in C++-code. These classes were polymorphic so an object with a class
name <code>zCVobLight:zCVob</code> contains both <a href="#entries">entries</a> of type <code>zCVob</code> and <code>zCVobLight</code>. The entries of the 
super-class always precede the <a href="#entries">entries</a> of the subclass, so the <code>zCVobLight:zCVob</code> would first contain all 
<a href="#entries">entries</a> of <code>zCVob</code> and then all <a href="#entries">entries</a> of <code>zCVobLight</code>. Objects without a class name just
contain a <code>%</code> instead.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Class and object names may not contain spaces.</p>
</div>
<p>The <em>version</em> of an object is a 32-bit unsigned number which denotes the version of the bottom-most subclass. The
version of object <code>[% oCMobInter:oCMOB:zCVob 35585 0]</code> would be <code>35585</code>. This version, however, only refers to the
<code>oCMobInter</code>-part.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>This leads to issues when trying to determine whether an object uses the <em>Gothic</em> or the <em>Gothic II</em> definition.
If the structure for <code>oCMobInter</code> did not change between the games, the version will be the same. This is not
necessarily true for <code>zVob</code> though. Its definition might have changed but this change is not reflected in the 
<code>version</code> field of the object.</p>
</div>
<p>The <em>index</em> field of the object is a 32-bit unsigned number which increments for every object with a class name in the
archive. In the <a href="#general-concepts">example</a> this can be seen with the objects <code>[% oCWorld:zCWorld 64513 0]</code> and 
<code>[% zCVob 39168 1]</code>. Objects without a class name have an <em>index</em> of <code>0</code>.</p>
<h2 id="entries">Entries</h2>
<p>The concept of entries only really applies to archives with <a href="#ascii">ascii</a> or <a href="#safe-binary">safe binary</a> encoding.
An entry originally represented a field in a C++-class which defined an <a href="#objects">object</a>. For this reason, each entry
has a name, a type and a value. The following entry types are supported:</p>
<table>
<thead>
<tr>
<th>Type Name</th>
<th>Type ID<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td>1</td>
<td><a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1">ISO-8859-1</a> encoded text</td>
</tr>
<tr>
<td><code>int</code></td>
<td>2</td>
<td>A 32-bit signed integer</td>
</tr>
<tr>
<td><code>float</code></td>
<td>3</td>
<td>An <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754</a> floating-point number</td>
</tr>
<tr>
<td><code>byte</code></td>
<td>4</td>
<td>An 8-bit unsigned integer</td>
</tr>
<tr>
<td><code>word</code></td>
<td>5</td>
<td>An 16-bit unsigned integer</td>
</tr>
<tr>
<td><code>bool</code></td>
<td>6</td>
<td>An boolean value<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></td>
</tr>
<tr>
<td><code>vec3</code></td>
<td>7</td>
<td>A set of 3 <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754</a> floating-point numbers</td>
</tr>
<tr>
<td><code>color</code></td>
<td>8</td>
<td>A set of 4 8-bit unsigned integers</td>
</tr>
<tr>
<td><code>raw</code></td>
<td>9</td>
<td>A set of an arbitrary amount of 8-bit unsigned integers</td>
</tr>
<tr>
<td><code>rawFloat</code></td>
<td>16</td>
<td>A set of an arbitrary amount of <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754</a> floating-point numbers</td>
</tr>
<tr>
<td><code>enum</code></td>
<td>17</td>
<td>A 32-bit unsigned integer<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup></td>
</tr>
<tr>
<td><code>hash</code></td>
<td>18</td>
<td>A 32-bit unsigned integer; specific to the <a href="#safe-binary">safe binary</a> encoding</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="ascii">ASCII</h2>
<p>ASCII-archives are human-readable ZEN archives, comparable to JSON. Contrary to its name, the file is not actually
using the <a href="https://en.wikipedia.org/wiki/ASCII">ASCII</a> text encoding. Rather these files are encoded in
<a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1">ISO-8859-1</a> or alternatively 
<a href="https://en.wikipedia.org/wiki/Windows-1252">Windows-1252</a> (because the characters used are encoded identically).</p>
<p>ASCII ZEN-archives use a line-based format. Every line after the header contains exactly one object start statement,
entry statement or object end token. Leading whitespace is ignored.</p>
<h3 id="header_1">Header</h3>
<p>The encoding specific header for the <em>ASCII</em>-encoding looks like this. Variable elements of the header have been
replaced by <code>&lt;...&gt;</code> placeholders. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>objects &lt;count&gt;
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>END
</code></pre></div>
<p><code>&lt;count&gt;</code> denotes the total number of <a href="#objects">objects</a> in the archive. Refer to the <a href="#general-concepts">example</a> 
above for a filled-out version of the header.</p>
<h3 id="objects_1">Objects</h3>
<p>As stated above, objects in ASCII-ZENs start with a line <code>[% oCWorld:zCWorld 64513 0]</code> defined as 
<code>[&lt;object name&gt; &lt;class name&gt; &lt;version&gt; &lt;index&gt;]</code>. This is explained further in the section about <a href="#objects">objects</a>.</p>
<h3 id="entries_1">Entries</h3>
<p>Entries in ASCII-ZENs follow the format <code>&lt;name&gt;:&lt;type&gt;=&lt;value&gt;</code> where <code>&lt;name&gt;</code> is a C++ identifier, <code>&lt;type&gt;</code> is one
of the type names mentioned in the <a href="#entries">entries</a> section with the exclusion of the <code>hash</code> type. <code>&lt;value&gt;</code> depends
on the given type. It has the following formats:</p>
<table>
<thead>
<tr>
<th>Type Name</th>
<th>Format</th>
<th>Regex</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td>An unlimited number of characters excluding newline characters</td>
<td><code>^[^\n\r]*</code></td>
<td><code>field=string:This is a string</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td>A decimal 32-bit integer</td>
<td><code>^[+-]?\d+$</code></td>
<td><code>field=int:199</code></td>
</tr>
<tr>
<td><code>float</code></td>
<td>A decimal floating point value with decimal separator <code>.</code></td>
<td><code>^[+-]?(\d+\.)?\d+$</code></td>
<td><code>field=float:-1.0</code></td>
</tr>
<tr>
<td><code>byte</code></td>
<td>A decimal 8-bit unsigned integer</td>
<td><code>^\d{1,3}$</code></td>
<td><code>field=byte:255</code></td>
</tr>
<tr>
<td><code>word</code></td>
<td>A decimal 16-bit unsigned integer</td>
<td><code>^\d+$</code></td>
<td><code>field=word:1001</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td>A decimal 1-bit integer</td>
<td><code>^[01]$</code></td>
<td><code>field=bool:1</code></td>
</tr>
<tr>
<td><code>vec3</code></td>
<td>A set of three floating point values</td>
<td><code>^[+-]?(\d+\.)?\d+ [+-]?(\d+\.)?\d+ [+-]?(\d+\.)?\d+$</code></td>
<td><code>field=vec3:1.0 -0.1 +100</code></td>
</tr>
<tr>
<td><code>color</code></td>
<td>A set of four 8-bit unsigned integers</td>
<td><code>^\d{1,3} \d{1,3} \d{1,3} \d{1,3}$</code></td>
<td><code>field=color:100 0 255 12</code></td>
</tr>
<tr>
<td><code>raw</code></td>
<td>An unlimited number of hexadecimal bytes</td>
<td><code>^([0-9A-Fa-f]{2})*</code></td>
<td><code>field=raw:0fac3256b1</code></td>
</tr>
<tr>
<td><code>rawFloat</code></td>
<td>An unlimited number of floating point values</td>
<td><code>^([+-]?(\d+\.)?\d+ )*</code></td>
<td><code>field=rawFloat:1.0 -100</code></td>
</tr>
<tr>
<td><code>enum</code></td>
<td>A decimal 32-bit unsigned integer</td>
<td><code>^\d+$</code></td>
<td><code>field=enum:10</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="binary">Binary</h2>
<p>Binary archives are little more than containers for raw bytes. They don't actually contain key-value pairs and they
don't allow for nesting objects.</p>
<h3 id="header_2">Header</h3>
<p>The encoding specific header for the <em>Binary</em>-encoding is the same as that of the <a href="#ascii">ascii</a> encoding. Variable 
elements of the header have been  replaced by <code>&lt;...&gt;</code> placeholders.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>objects &lt;count&gt;
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>END
</code></pre></div>
<p><code>&lt;count&gt;</code> denotes the total number of <a href="#objects">objects</a> in the archive.</p>
<h3 id="objects_2">Objects</h3>
<p>Objects in binary ZENs don't work like they do in the <a href="#ascii">ascii</a> and <a href="#safe-binary">safe binary</a> encodings. No
object end marker is stored and the beginning of an object does not follow the same format.</p>
<div class="highlight"><span class="filename">Binary ZEN object begin structure</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="cp">#pragma pack(push, 1)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">zen_object_begin</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">object_size</span><span class="p">;</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">index</span><span class="p">;</span><span class="w"> </span><span class="c1">// (3)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">object_name</span><span class="p">;</span><span class="w"> </span><span class="c1">// Note: (4)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">class_name</span><span class="p">;</span><span class="w"> </span><span class="c1">// Note: (5)</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">};</span><span class="w"></span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="cp">#pragma pack(pop)</span>
</code></pre></div>
<ol>
<li>Contains the size of the object in bytes, including the header.</li>
<li>The <em>version</em> number of the object as described in <a href="#objects">Objects</a></li>
<li>The <em>index</em> of the object as described in <a href="#objects">Objects</a></li>
<li>The <em>object name</em> of the object as described in <a href="#objects">Objects</a>. <strong>This insinuates that the string ends with a
   null-termination character (<code>\0</code>). In fact, it ends with a newline character (<code>\n</code>), however!</strong></li>
<li>The <em>class name</em> of the object as described in <a href="#objects">Objects</a>. <strong>This insinuates that the string ends with a
   null-termination character (<code>\0</code>). In fact, it ends with a newline character (<code>\n</code>), however!</strong></li>
</ol>
<h3 id="entries_2">Entries</h3>
<p>Binary ZENs just contains packed bytes with no added type annotations. This makes it very difficult to determine the
layout of structures within it without having access to the original source code.</p>
<p>To read an integer from a binary ZEN for example, the next four bytes are read in literally like this (assuming a 
little-endian architecture).</p>
<div class="highlight"><span class="filename">Binary ZEN entry read scalar example</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kt">int32_t</span><span class="w"> </span><span class="nf">zen_binary_read_int</span><span class="p">(</span><span class="kt">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">fp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">value</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fp</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>On big-endian architectures, the value read would have to be transformed to little-endian afterwards. This method of
extracting values from binary ZENs is also used for aggregate types, like the <code>vec3</code>. Instead of reading just one
float from the input, three are read like this.</p>
<div class="highlight"><span class="filename">Binary ZEN entry read vector example</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vec3</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="p">}</span><span class="w"> </span><span class="n">vec3_t</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">vec3_t</span><span class="w"> </span><span class="nf">zen_binary_read_int</span><span class="p">(</span><span class="kt">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">fp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="n">vec3_t</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fp</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fp</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">.</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fp</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Refer to the following chart for type sizes.</p>
<table>
<thead>
<tr>
<th>Type Name</th>
<th>C-equivalent</th>
<th>Byte Count</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code>char[]</code></td>
<td><code>1 * n</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>int32_t</code></td>
<td>4</td>
</tr>
<tr>
<td><code>float</code></td>
<td><code>float</code></td>
<td>4</td>
</tr>
<tr>
<td><code>byte</code></td>
<td><code>uint8_t</code></td>
<td>1</td>
</tr>
<tr>
<td><code>word</code></td>
<td><code>uint16_t</code></td>
<td>2</td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>uint8_t</code></td>
<td>1</td>
</tr>
<tr>
<td><code>vec3</code></td>
<td><code>struct { float, float, float }</code></td>
<td><code>4 * 3</code></td>
</tr>
<tr>
<td><code>color</code></td>
<td><code>struct { uint8_t, uint8_t, uint8_t, uint8_t }</code></td>
<td><code>1 * 4</code></td>
</tr>
<tr>
<td><code>raw</code></td>
<td><code>uint8_t[]</code></td>
<td><code>1 * n</code></td>
</tr>
<tr>
<td><code>rawFloat</code></td>
<td><code>float[]</code></td>
<td><code>4 * n</code></td>
</tr>
<tr>
<td><code>enum</code></td>
<td><code>uint32_t</code></td>
<td>4</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="safe-binary">Safe Binary</h2>
<p>Safe binary archives store binary values annotated with field types and names. They are the most prevalent types of
archives and also the ones in which world data is stored. The values of entries as well as their prefixes are stored
in a packed binary format. This encoding is not fully reverse-engineered.</p>
<h3 id="header_3">Header</h3>
<p>The header of safe binary archives is also binary and has the following structure.</p>
<div class="highlight"><span class="filename">Safe binary ZEN header structure</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="cp">#pragma pack(push, 1)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">zen_binsafe_header</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">bs_version</span><span class="p">;</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">object_count</span><span class="p">;</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">hash_table_offset</span><span class="p">;</span><span class="w"> </span><span class="c1">// (3)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">};</span><span class="w"></span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="cp">#pragma pack(pop)</span>
</code></pre></div>
<ol>
<li>A separate version identifier for the version of the safe binary encoding used.</li>
<li>The total number of objects in the archive</li>
<li>The offset of the hash table from the beginning of the file in bytes; discussed below.</li>
</ol>
<p>In addition to the secondary header, safe binary archives also contain a so-called hash table<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup> which stores field
name information. The hash table is a binary structure as well; it looks like this.</p>
<div class="highlight"><span class="filename">Safe binary ZEN hash table structure</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="cp">#pragma pack(push, 1)</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">zen_binsafe_hashtable_entry</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">name_length</span><span class="p">;</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">insertion_index</span><span class="p">;</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">hash_value</span><span class="p">;</span><span class="w"> </span><span class="c1">// (3)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">name</span><span class="p">[];</span><span class="w"> </span><span class="c1">// (4)</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="p">};</span><span class="w"></span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="k">struct</span><span class="w"> </span><span class="nc">zen_binsafe_hashtable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="c1">// (5)</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="n">zen_binsafe_hashtable_entry</span><span class="w"> </span><span class="n">entries</span><span class="p">[];</span><span class="w"> </span><span class="c1">// (6)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="p">};</span><span class="w"></span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="cp">#pragma pack(pop)</span>
</code></pre></div>
<ol>
<li>The length of the name string at the end of the structure.</li>
<li>The index of this entry in the hashtable <code>entries</code> member array.</li>
<li>The hash value of the entry. Its purpose is currently unknown.</li>
<li>The name of the entry. This name is the field name of the entry as explained below.</li>
<li>The number of entries in the hash table. Corresponds with the length of the <code>entries</code> member array.</li>
<li>An array of all hash table entries; unordered.</li>
</ol>
<h3 id="objects_3">Objects</h3>
<p>In safe binary ZENs, objects are handled in almost the same way entries are. Objects definitions are preceded by the
string type identifier <code>\x01</code> and a 16-bit string length value. The value of this string is the same as the object
definition for ASCII-ZENs: Objects start with a line <code>[% oCWorld:zCWorld 64513 0]</code> defined as
<code>[&lt;object name&gt; &lt;class name&gt; &lt;version&gt; &lt;index&gt;]</code>. This is explained further in the section about <a href="#objects">objects</a>.</p>
<p>A full object definition might look like this: <code>\x01\x1B\x00[% oCWorld:zCWorld 64513 0]</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that objects are never preceded by a field name like entries are.</p>
</div>
<h3 id="entries_3">Entries</h3>
<p>Every entry in safe binary ZENs is preceded by a field name index and a type identifier including a length if
applicable. File name indexes start with a <code>\x12</code> which is followed by a 32-bit unsigned integer, indicating an index
into the hash table discussed above. The name of the hash table entry at that index is the name of the field.</p>
<p>A boolean entry in this format might look like <code>\x12\x01\x00\00\x00\x06\x01\x00\x00\x00</code>. It hashtable index is <code>1</code> 
and its value is <code>true</code>. Type IDs are always <code>uint8_t</code>s and hashtable indices are always <code>uint32_t</code>s.</p>
<p>Reference the table below for all types in safe binary archives.</p>
<table>
<thead>
<tr>
<th>Type Name</th>
<th>Type ID</th>
<th>Has Length?</th>
<th>C-equivalent</th>
<th>Byte Count</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td>1</td>
<td>Yes</td>
<td><code>char[]</code></td>
<td><code>1 * n</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td>2</td>
<td>No</td>
<td><code>int32_t</code></td>
<td>4</td>
</tr>
<tr>
<td><code>float</code></td>
<td>3</td>
<td>No</td>
<td><code>float</code></td>
<td>4</td>
</tr>
<tr>
<td><code>byte</code></td>
<td>4</td>
<td>No</td>
<td><code>uint8_t</code></td>
<td>1</td>
</tr>
<tr>
<td><code>word</code></td>
<td>5</td>
<td>No</td>
<td><code>uint16_t</code></td>
<td>2</td>
</tr>
<tr>
<td><code>bool</code></td>
<td>6</td>
<td>No</td>
<td><code>uint32_t</code></td>
<td>4</td>
</tr>
<tr>
<td><code>vec3</code></td>
<td>7</td>
<td>No</td>
<td><code>struct { float, float, float }</code></td>
<td><code>4 * 3</code></td>
</tr>
<tr>
<td><code>color</code></td>
<td>8</td>
<td>No</td>
<td><code>struct { uint8_t, uint8_t, uint8_t, uint8_t }</code></td>
<td><code>1 * 4</code></td>
</tr>
<tr>
<td><code>raw</code></td>
<td>9</td>
<td>Yes</td>
<td><code>uint8_t[]</code></td>
<td><code>1 * n</code></td>
</tr>
<tr>
<td><code>rawFloat</code></td>
<td>16</td>
<td>Yes</td>
<td><code>float[]</code></td>
<td><code>4 * n</code></td>
</tr>
<tr>
<td><code>enum</code></td>
<td>17</td>
<td>No</td>
<td><code>uint32_t</code></td>
<td>4</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Entries with a length prefix, are encoded like this: <code>\x12\x01\x00\00\x00\x01\x0D\x00Hello, world!</code>. It hashtable 
index is <code>1</code>, its length is <code>0x0D</code> and its value is <code>Hello, World!</code>. Note that the length is always a <code>uint16_t</code>
and always follows directly after the type ID.</p>
</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>The type index is relevant only for <a href="#safe-binary">safe binary</a> encoded archives.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>The actual representation of this value changes between encodings. With the <a href="#safe-binary">safe binary</a> encoding
  a boolean value is represented as a 32-bit unsigned integer while it is represented as an 8-bit integer in the 
  <a href="#binary">binary</a> encoding.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Enums represent an actual enumeration value in C++-code.&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>The origin of that name is unknown. It has been used in 
  <a href="https://github.com/ataulien/ZenLib/blob/master/zenload/parserImplBinSafe.cpp#L190-L195">ZenLib</a> to describe this 
  element of the format.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../vdf/" class="md-footer__link md-footer__link--prev" aria-label="Previous: The VDF file format" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              The VDF file format
            </div>
          </div>
        </a>
      
      
        
        <a href="../../miscellaneous/chunked/" class="md-footer__link md-footer__link--next" aria-label="Next: The chunked binary format" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              The chunked binary format
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
    
  </body>
</html>